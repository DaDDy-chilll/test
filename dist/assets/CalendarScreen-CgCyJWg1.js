import{E as e,h as N,G as I,r as g,U as _,T as H,H as Y,I as A}from"./index-B2BLnhiH.js";import{t as u,c as f,s as M,f as d,E as w}from"./EventListItem-CTwFsOg0.js";import{u as K}from"./useFetch-z3vR4tLH.js";import{Q as W}from"./queryKey-UAMLCRrd.js";function C(s,t){const n=u(s);if(isNaN(t))return f(s,NaN);if(!t)return n;const a=n.getDate(),i=f(s,n.getTime());i.setMonth(n.getMonth()+t+1,0);const l=i.getDate();return a>=l?i:(n.setFullYear(i.getFullYear(),i.getMonth(),a),n)}function B(s){return f(s,Date.now())}function P(s,t){const n=M(s),a=M(t);return+n==+a}function R(s){const t=u(s),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function V(s,t){const n=u(s.start),a=u(s.end);let i=+n>+a;const l=i?+n:+a,c=i?a:n;c.setHours(0,0,0,0);let p=1;const h=[];for(;+c<=l;)h.push(u(c)),c.setDate(c.getDate()+p),c.setHours(0,0,0,0);return i?h.reverse():h}function z(s){const t=u(s);return t.setDate(1),t.setHours(0,0,0,0),t}function y(s){return u(s).getDay()}function b(s){return P(s,B(s))}function J(s,t){return C(s,-t)}const Q=({day:s,todaysEvents:t,handleClick:n})=>{const a=()=>n(t);return e.jsxs("div",{className:N("h-20 flex flex-col rounded-md items-center justify-center active:scale-90 transition-all duration-100 cursor-pointer ",{"border border-red-400 bg-[#E5D5D9]":b(s),"bg-[#E5D5D9]":!b(s)}),onClick:a,children:[e.jsx("div",{className:N("w-8 h-8 flex items-center justify-center mx-auto"),children:d(s,"d")}),t.length!==0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"bg-primaryColor w-2 h-2 rounded-full"}),t.length>1&&e.jsxs("p",{className:"text-xs text-primaryColor",children:["+",t.length]})]})]})},$=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],ne=()=>{const{token:s}=I(r=>r.auth),[t,n]=g.useState(new Date),[a,i]=g.useState([]),l=z(t),c=R(t),{data:p,isLoading:h,isError:U,isSuccess:q,error:X}=K({endpoint:_.EVENTS,token:s,key:W.EVENTS}),j=p||[],E=d(new Date,"yyyy-MM-dd"),D=g.useMemo(()=>j.reduce((r,o)=>{const m=d(new Date(o.date),"yyyy-MM-dd");return r[m]||(r[m]=[]),r[m].push(o),r},{}),[j]),x=D[E]||[],k=()=>n(C(t,1)),F=()=>n(J(t,1)),S=V({start:l,end:c}),T=y(l)===0?6:y(l)-1,L=y(c)===0?0:7-y(c),O=r=>i(r);return e.jsxs(e.Fragment,{children:[h&&e.jsx(H,{isLoading:h,className:"h-[calc(100vh-68px)]"}),e.jsxs(Y.div,{variants:G,initial:"initial",animate:"animate",exit:"exit",className:"w-full  grid grid-cols-3 gap-x-4 p-4",children:[e.jsxs("div",{className:"col-span-2 rounded-lg bg-[#F0F0F0] p-4 shadow-lg",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[e.jsx("button",{onClick:F,className:"bg-primaryColor text-white p-2 rounded hover:bg-primaryColor/30",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})})}),e.jsx("h2",{className:"text-center text-xl",children:d(t,"MMMM yyyy")}),e.jsx("button",{onClick:k,className:"bg-primaryColor text-white p-2 rounded hover:bg-primaryColor/30",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[$.map(r=>e.jsx("div",{className:"font-normal py-2 text-center bg-[#F6D5D5] text-secondaryColor rounded-md",children:r},r)),Array.from({length:T}).map((r,o)=>e.jsx("div",{className:"p-2 bg-[#E5D5D9] rounded-md text-center "},`empty-${o}`)),S.map((r,o)=>{const m=d(r,"yyyy-MM-dd"),v=D[m]||[];return e.jsx(Q,{day:r,todaysEvents:v,handleClick:()=>O(v)},o)}),Array.from({length:L}).map((r,o)=>e.jsx("div",{className:"p-2 bg-[#E5D5D9] rounded-md text-center "},`empty-${o}`))]})]}),e.jsxs("div",{className:"col-span-1 px-4 rounded-lg bg-[#F0F0F0] h-full",children:[e.jsxs("h2",{className:"text-center text-base my-6",children:["~~",A.meetings]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:a.length>0?d(a[0].date,"yyyy-MM-dd"):x.length>0&&d(x[0].date,"yyyy-MM-dd")}),e.jsxs("select",{className:"bg-primaryColor text-white p-2 rounded-md text-xs",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"JLPT N4",children:"JLPT N4"})]})]}),e.jsx("div",{className:"overflow-y-auto my-5 h-[calc(100vh-250px)] flex flex-col gap-2",children:a.length>0?a.map((r,o)=>e.jsx(w,{event:r},o)):x.length>0?x.map((r,o)=>e.jsx(w,{event:r},o)):e.jsx("p",{className:"text-center text-gray-500 pt-10",children:"No events for this day"})})]})]})]})},G={initial:{opacity:0},animate:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}};export{ne as default};
