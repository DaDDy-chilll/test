import{E as e,U as w,V as de,O as n,G as ce,I as ue,H as xe,X as he,J as pe,r as a,ab as M,Q as f,a0 as k,M as g,$ as me,N as fe,S as ge,T as je,a6 as ye,ac as ke,ad as we,ae as Ce,af as be,a8 as ve,W as V}from"./index-p5wuvO-B.js";import{U as Ne,M as Se}from"./UserProfileSkeleton-BqvHKj0y.js";import{S as Le,a as Me}from"./index-DGb4aLZI.js";const Te=({hasMore:o,click:d})=>{const c=()=>{o&&d()};return e.jsxs(w.button,{onClick:c,variants:Ee,initial:"initial",animate:"animate",exit:"exit",className:`w-full h-full flex flex-col justify-center items-center bg-gray-100 border rounded-lg shadow py-2  ${o?"hover:bg-gray-200 hover:shadow-lg":""} cursor-pointer group`,disabled:!o,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-12 h-12 text-gray-400 mb-2 ${o?"group-hover:text-primaryColor":""}`,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),e.jsx("p",{className:`text-gray-500 text-sm ${o?"group-hover:text-primaryColor":""}`,children:o?"See More Matches":"No More Matches"})]})},Ee={initial:{opacity:0},animate:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}},De=({handleShowDetail:o,matchedData:d,likeorUnlikeHandler:c})=>{const u=()=>{o(d.id)},{m_basicinfos:r}=d,C=`https://api.japanjob.exbrainedu.com/v1/file/photo/${r.profile_path}`;return e.jsx(w.div,{onClick:u,variants:Ue,initial:"initial",animate:"animate",exit:"exit",className:"w-full h-full  bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 py-2 hover:shadow-lg hover:bg-gray-200 cursor-pointer",children:e.jsxs("div",{className:"flex w-full h-full  flex-col items-center py-3 px-2",children:[e.jsx("img",{className:"w-16 h-16 mb-3 rounded-full shadow-lg",src:r.profile_path?C:de,alt:r.name,crossOrigin:"anonymous"}),e.jsx("h5",{className:"my-2 text-lg font-medium text-gray-900 dark:text-white",children:r.name}),e.jsxs("div",{className:"flex flex-row justify-center items-center  gap-x-6 w-full bg-gray-300 rounded-sm h-40",children:[e.jsxs("div",{className:"flex flex-col gap-y-6 h-full justify-center",children:[e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.age,":"]}),e.jsx("p",{children:ce(r.dob).fromNow().split(" ")[0]})]}),e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.gender,":"]}),e.jsx("p",{children:r.gender===0?n.male:n.female})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-6 h-full justify-center",children:[e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.location,":"]}),e.jsx("p",{children:r.live_in_japan===1?n.japan:n.myanmar})]}),e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.passport,":"]}),e.jsx("p",{children:r.has_passport===1?n.yes:n.no})]})]})]}),e.jsxs("div",{className:"flex mt-4 md:mt-6 w-full justify-evenly",children:[e.jsx("button",{onClick:i=>c(i,d.id),name:"unlike",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3,stroke:"currentColor",className:"size-8 text-secondaryColor/40 hover:scale-125 hover:text-secondaryColor transition-all duration-300",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})})}),e.jsx("button",{onClick:i=>c(i,d.id),name:"like",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-8 text-primaryColor/40 hover:scale-125 hover:text-primaryColor transition-all duration-300",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})})})]})]})})},Ue={initial:{opacity:0},animate:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}},T=()=>e.jsx(Le,{baseColor:"#d6d6d6",highlightColor:"#edeceb",children:e.jsx("div",{className:"w-full h-full",children:e.jsx(Me,{height:"100%",width:"100%"})})}),Be=()=>{var q,F,H,K,P,R;const o=ue(),d=xe(),c=he(),{token:u}=pe(t=>t.auth),[r,C]=a.useState([]),[i,E]=a.useState({id:null,name:""}),[j,D]=a.useState(null),[l,U]=a.useState(!0),[x,z]=a.useState(1),[h,$]=a.useState(3),[G,b]=a.useState(!1),[W,Q]=a.useState({jobId:null,like:null}),Z=()=>{const t=new URLSearchParams;return t.append("liked",l.toString()),x>0&&t.append("page",x.toString()),h>0&&t.append("limit",h.toString()),t.toString()},{data:v,isLoading:_,isSuccess:J}=M({queryKey:[f.JOBS],queryFn:()=>k({endpoint:g.JOBS,method:"GET",token:u}),enabled:!!u}),p=((q=v==null?void 0:v.data)==null?void 0:q.map(t=>({id:t.id,name:t.job_title})))||[],{data:s,isLoading:Y,refetch:y,isSuccess:A}=M({queryKey:[f.MATCHED,i==null?void 0:i.id,x,l,h],queryFn:()=>i.id?k({endpoint:`${g.MATCHED}/${i.id}?${Z()}`,method:"GET",token:u}):[],enabled:!!i.id&&!!x&&!!l&&!!h}),{data:N,isLoading:I}=M({queryKey:[f.MATCHED_DETAIL],queryFn:()=>j?k({endpoint:`${g.USER_DETAILS}/${j}`,method:"GET",token:u}):[],enabled:!!j}),{mutate:X,isPending:B,isSuccess:O,data:_e}=me({mutationFn:({endpoint:t,body:m})=>k({endpoint:t,method:"POST",body:m,token:u}),onSuccess:()=>{l&&b(!0),c.invalidateQueries({queryKey:[f.MATCHED]})}}),ee=t=>E(t),te=t=>{document.body.style.overflow="hidden",D(t)},se=()=>{D(null),document.body.style.overflowY="auto"},ie=()=>{(s==null?void 0:s.data.totalUsers)!==(r==null?void 0:r.length)&&$(t=>t+4)},ne=t=>{C(m=>{if(i.id!==W.jobId||l!==W.like)return t;const S=new Set(m.map(L=>L.id)),le=t.filter(L=>!S.has(L.id));return[...m,...le]}),Q({jobId:i.id,like:l})},re=(t,m)=>{t.stopPropagation();const S=t.currentTarget.name;i&&(X({endpoint:S==="like"?g.LIKE:g.UNLIKE,body:{user_id:m,jobs_id:i.id}}),c.invalidateQueries({queryKey:[f.MATCHED]}))},ae=()=>{b(!1),d(V.CHAT)},oe=()=>{d(V.JOBS)};return a.useEffect(()=>{o(fe(n.matches))},[o]),a.useEffect(()=>{J&&p.length>0&&E(p[0])},[J]),a.useEffect(()=>{var t;A&&((t=s==null?void 0:s.data)!=null&&t.users)&&ne(s.data.users)},[A,(F=s==null?void 0:s.data)==null?void 0:F.users,i.id,l]),a.useEffect(()=>{i.id&&(z(1),$(3),y())},[i.id,l,y]),a.useEffect(()=>{(x>1||h>3||O)&&y()},[x,h,O,y]),e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsxs("title",{children:[n.matches," - Japan Job"]})}),(B||_)&&e.jsx(je,{isLoading:B||_,className:"h-[calc(100vh-68px)]"}),G&&e.jsx(ye,{message:n.goToChat,onConfirm:ae,onCancel:()=>b(!1)}),e.jsxs(w.main,{variants:$e,initial:"initial",animate:"animate",exit:"exit",className:"w-full py-3 relative",children:[e.jsxs("div",{className:"flex justify-between px-3",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{className:`p-2 text-sm ${l?"border-b border-primaryColor text-primaryColor":"text-gray-400"}`,onClick:()=>U(!0),children:n.userLikeYou}),e.jsx("button",{className:`p-2 text-sm ${l?"text-gray-400":"border-b border-primaryColor text-primaryColor"}`,onClick:()=>U(!1),children:n.otherMatches})]}),e.jsxs(ke,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex w-auto justify-between items-center gap-2 bg-primaryColor text-white px-4 py-1 rounded-md",children:[e.jsx("p",{className:"text-sm mr-3",children:i.name||n.chooseJobType}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})})]})}),e.jsx(Ce,{className:` ${p.length>5?"overflow-y-auto h-[11rem]":"overflow-y-hidden"}`,children:p.length>0&&p.map(t=>e.jsx(be,{onClick:()=>ee(t),children:e.jsx("p",{children:t.name})},"z"+t.id))})]})]}),e.jsxs(ve,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-2 p-2 h-[calc(100vh-150px)] overflow-y-auto auto-rows-[350px]",children:Y?e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(T,{}),e.jsx(T,{})]}):s&&((K=(H=s==null?void 0:s.data)==null?void 0:H.users)==null?void 0:K.length)>0?e.jsxs(e.Fragment,{children:[(P=s==null?void 0:s.data)==null?void 0:P.users.map(t=>e.jsx(De,{handleShowDetail:te,matchedData:t,jobType:i,likeorUnlikeHandler:re},t.id)),e.jsx(Te,{hasMore:((R=s==null?void 0:s.data)==null?void 0:R.totalUsers)>(r==null?void 0:r.length),click:ie})]}):e.jsxs("div",{className:"text-center  flex-col gap-4 text-gray-400 col-span-4 h-full flex justify-center items-center",children:[e.jsxs("svg",{width:"152px",height:"152px",viewBox:"0 0 24.00 24.00",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),e.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",e.jsx("path",{opacity:"0.4",d:"M17.9981 7.16C17.9381 7.15 17.8681 7.15 17.8081 7.16C16.4281 7.11 15.3281 5.98 15.3281 4.58C15.3281 3.15 16.4781 2 17.9081 2C19.3381 2 20.4881 3.16 20.4881 4.58C20.4781 5.98 19.3781 7.11 17.9981 7.16Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{opacity:"0.4",d:"M16.9675 14.4402C18.3375 14.6702 19.8475 14.4302 20.9075 13.7202C22.3175 12.7802 22.3175 11.2402 20.9075 10.3002C19.8375 9.59016 18.3075 9.35016 16.9375 9.59016",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{opacity:"0.4",d:"M5.96656 7.16C6.02656 7.15 6.09656 7.15 6.15656 7.16C7.53656 7.11 8.63656 5.98 8.63656 4.58C8.63656 3.15 7.48656 2 6.05656 2C4.62656 2 3.47656 3.16 3.47656 4.58C3.48656 5.98 4.58656 7.11 5.96656 7.16Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{opacity:"0.4",d:"M6.9975 14.4402C5.6275 14.6702 4.1175 14.4302 3.0575 13.7202C1.6475 12.7802 1.6475 11.2402 3.0575 10.3002C4.1275 9.59016 5.6575 9.35016 7.0275 9.59016",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{d:"M12.0001 14.6302C11.9401 14.6202 11.8701 14.6202 11.8101 14.6302C10.4301 14.5802 9.33008 13.4502 9.33008 12.0502C9.33008 10.6202 10.4801 9.47021 11.9101 9.47021C13.3401 9.47021 14.4901 10.6302 14.4901 12.0502C14.4801 13.4502 13.3801 14.5902 12.0001 14.6302Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{d:"M9.0907 17.7804C7.6807 18.7204 7.6807 20.2603 9.0907 21.2003C10.6907 22.2703 13.3107 22.2703 14.9107 21.2003C16.3207 20.2603 16.3207 18.7204 14.9107 17.7804C13.3207 16.7204 10.6907 16.7204 9.0907 17.7804Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," "]})]}),e.jsx("p",{className:"text-gray-500 text-lg",children:n.noMatchesYet})]})}),(j||I)&&e.jsx(w.div,{className:"absolute top-0 left-0 w-full h-full bg-gray-100 z-50",variants:We,initial:"initial",animate:"animate",exit:"exit",children:e.jsxs("span",{className:"w-full h-full relative",children:[I?e.jsx(Ne,{}):e.jsx(Se,{applicantDetail:N==null?void 0:N.data,className:"h-full w-full overflow-y-auto"}),e.jsx("button",{onClick:se,className:"absolute top-3 left-3  bg-white w-10 h-10 rounded-full flex justify-center items-center text-secondaryColor",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})})})]})},"matchDetail")]})]}),p.length===0&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white w-[36%] h-[30%] pt-10 pb-8 px-14 flex flex-col justify-between rounded-lg shadow-lg",children:[e.jsx("p",{className:"mb-4",children:n.createJobFirst}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded",onClick:oe,children:n.confirm})})]})})]})},$e={initial:{opacity:0},animate:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}},We={initial:{opacity:0,x:100},animate:{opacity:1,x:0,transition:{duration:.2}},exit:{opacity:0,x:100,transition:{duration:.2}}};export{Be as default};
