import{E as e,U as C,V as oe,O as n,G as le,I as de,H as ce,X as ue,J as xe,r as a,aa as T,Q as f,a0 as k,M as g,$ as he,N as pe,S as me,T as fe,a6 as ge,ab as je,ac as ye,ad as ke,ae as Ce,a7 as we,W as ve}from"./index-DgIL6vzg.js";import{U as be,M as Ne}from"./UserProfileSkeleton-qdfGq1O5.js";import{S as Se,a as Le}from"./index-CCVGW56o.js";const Me=({hasMore:o,click:d})=>{const c=()=>{o&&d()};return e.jsxs(C.button,{onClick:c,variants:Te,initial:"initial",animate:"animate",exit:"exit",className:`w-full h-full flex flex-col justify-center items-center bg-gray-100 border rounded-lg shadow py-2  ${o?"hover:bg-gray-200 hover:shadow-lg":""} cursor-pointer group`,disabled:!o,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-12 h-12 text-gray-400 mb-2 ${o?"group-hover:text-primaryColor":""}`,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),e.jsx("p",{className:`text-gray-500 text-sm ${o?"group-hover:text-primaryColor":""}`,children:o?"See More Matches":"No More Matches"})]})},Te={initial:{opacity:0},animate:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}},Ee=({handleShowDetail:o,matchedData:d,likeorUnlikeHandler:c})=>{const u=()=>{o(d.id)},{m_basicinfos:r}=d,w=`https://api.japanjob.exbrainedu.com/v1/file/photo/${r.profile_path}`;return e.jsx(C.div,{onClick:u,variants:De,initial:"initial",animate:"animate",exit:"exit",className:"w-full h-full  bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 py-2 hover:shadow-lg hover:bg-gray-200 cursor-pointer",children:e.jsxs("div",{className:"flex w-full h-full  flex-col items-center py-3 px-2",children:[e.jsx("img",{className:"w-16 h-16 mb-3 rounded-full shadow-lg",src:r.profile_path?w:oe,alt:r.name,crossOrigin:"anonymous"}),e.jsx("h5",{className:"my-2 text-lg font-medium text-gray-900 dark:text-white",children:r.name}),e.jsxs("div",{className:"flex flex-row justify-center items-center  gap-x-6 w-full bg-gray-300 rounded-sm h-40",children:[e.jsxs("div",{className:"flex flex-col gap-y-6 h-full justify-center",children:[e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.age,":"]}),e.jsx("p",{children:le(r.dob).fromNow().split(" ")[0]})]}),e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.gender,":"]}),e.jsx("p",{children:r.gender===0?n.male:n.female})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-6 h-full justify-center",children:[e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.location,":"]}),e.jsx("p",{children:r.live_in_japan===1?n.japan:n.myanmar})]}),e.jsxs("span",{className:"flex gap-2 text-normal font-medium text-gray-700",children:[e.jsxs("p",{children:[n.passport,":"]}),e.jsx("p",{children:r.has_passport===1?n.yes:n.no})]})]})]}),e.jsxs("div",{className:"flex mt-4 md:mt-6 w-full justify-evenly",children:[e.jsx("button",{onClick:i=>c(i,d.id),name:"unlike",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3,stroke:"currentColor",className:"size-8 text-secondaryColor/40 hover:scale-125 hover:text-secondaryColor transition-all duration-300",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})})}),e.jsx("button",{onClick:i=>c(i,d.id),name:"like",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-8 text-primaryColor/40 hover:scale-125 hover:text-primaryColor transition-all duration-300",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})})})]})]})})},De={initial:{opacity:0},animate:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}},E=()=>e.jsx(Se,{baseColor:"#d6d6d6",highlightColor:"#edeceb",children:e.jsx("div",{className:"w-full h-full",children:e.jsx(Le,{height:"100%",width:"100%"})})}),qe=()=>{var O,H,K,P,R,V;const o=de(),d=ce(),c=ue(),{token:u}=xe(t=>t.auth),[r,w]=a.useState([]),[i,D]=a.useState({id:null,name:""}),[j,U]=a.useState(null),[l,$]=a.useState(!0),[x,F]=a.useState(1),[h,W]=a.useState(3),[G,v]=a.useState(!1),[_,Q]=a.useState({jobId:null,like:null}),z=()=>{const t=new URLSearchParams;return t.append("liked",l.toString()),x>0&&t.append("page",x.toString()),h>0&&t.append("limit",h.toString()),t.toString()},{data:b,isLoading:A,isSuccess:I}=T({queryKey:[f.JOBS],queryFn:()=>k({endpoint:g.JOBS,method:"GET",token:u}),enabled:!!u}),m=((O=b==null?void 0:b.data)==null?void 0:O.map(t=>({id:t.id,name:t.job_title})))||[],{data:s,isLoading:Z,refetch:y,isSuccess:q}=T({queryKey:[f.MATCHED,i==null?void 0:i.id,x,l,h],queryFn:()=>i.id?k({endpoint:`${g.MATCHED}/${i.id}?${z()}`,method:"GET",token:u}):[],enabled:!!i.id&&!!x&&!!l&&!!h}),{data:N,isLoading:B}=T({queryKey:[f.MATCHED_DETAIL],queryFn:()=>j?k({endpoint:`${g.USER_DETAILS}/${j}`,method:"GET",token:u}):[],enabled:!!j}),{mutate:Y,isPending:J,isSuccess:S,data:We}=he({mutationFn:({endpoint:t,body:p})=>k({endpoint:t,method:"POST",body:p,token:u}),onSuccess:()=>{c.invalidateQueries({queryKey:[f.MATCHED]})}}),X=t=>D(t),ee=t=>{document.body.style.overflow="hidden",U(t)},te=()=>{U(null),document.body.style.overflowY="auto"},se=()=>{(s==null?void 0:s.data.totalUsers)!==(r==null?void 0:r.length)&&W(t=>t+4)},ie=t=>{w(p=>{if(i.id!==_.jobId||l!==_.like)return t;const L=new Set(p.map(M=>M.id)),ae=t.filter(M=>!L.has(M.id));return[...p,...ae]}),Q({jobId:i.id,like:l})},ne=(t,p)=>{t.stopPropagation();const L=t.currentTarget.name;i&&(Y({endpoint:L==="like"?g.LIKE:g.UNLIKE,body:{user_id:p,jobs_id:i.id}}),c.invalidateQueries({queryKey:[f.MATCHED]}))},re=()=>{v(!1),d(ve.CHAT)};return a.useEffect(()=>{o(pe(n.matches))},[o]),a.useEffect(()=>{I&&m.length>0&&D(m[0])},[I]),a.useEffect(()=>{var t;q&&((t=s==null?void 0:s.data)!=null&&t.users)&&ie(s.data.users)},[q,(H=s==null?void 0:s.data)==null?void 0:H.users,i.id,l]),a.useEffect(()=>{i.id&&(F(1),W(3),y())},[i.id,l,y]),a.useEffect(()=>{S&&l&&v(!0),(x>1||h>3||S)&&y()},[x,h,S,y]),e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsxs("title",{children:[n.matches," - Japan Job"]})}),(J||A)&&e.jsx(fe,{isLoading:J||A,className:"h-[calc(100vh-68px)]"}),G&&e.jsx(ge,{message:n.goToChat,onConfirm:re,onCancel:()=>v(!1)}),e.jsxs(C.main,{variants:Ue,initial:"initial",animate:"animate",exit:"exit",className:"w-full py-3 relative",children:[e.jsxs("div",{className:"flex justify-between px-3",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{className:`p-2 text-sm ${l?"border-b border-primaryColor text-primaryColor":"text-gray-400"}`,onClick:()=>$(!0),children:n.userLikeYou}),e.jsx("button",{className:`p-2 text-sm ${l?"text-gray-400":"border-b border-primaryColor text-primaryColor"}`,onClick:()=>$(!1),children:n.otherMatches})]}),e.jsxs(je,{children:[e.jsx(ye,{children:e.jsxs("div",{className:"flex w-auto justify-between items-center gap-2 bg-primaryColor text-white px-4 py-1 rounded-md",children:[e.jsx("p",{className:"text-sm mr-3",children:i.name||n.chooseJobType}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})})]})}),e.jsx(ke,{className:` ${m.length>5?"overflow-y-auto h-[11rem]":"overflow-y-hidden"}`,children:m.length>0&&m.map(t=>e.jsx(Ce,{onClick:()=>X(t),children:e.jsx("p",{children:t.name})},"z"+t.id))})]})]}),e.jsxs(we,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-2 p-2 h-[calc(100vh-150px)] overflow-y-auto auto-rows-[350px]",children:Z?e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsx(E,{}),e.jsx(E,{})]}):s&&((P=(K=s==null?void 0:s.data)==null?void 0:K.users)==null?void 0:P.length)>0?e.jsxs(e.Fragment,{children:[(R=s==null?void 0:s.data)==null?void 0:R.users.map(t=>e.jsx(Ee,{handleShowDetail:ee,matchedData:t,jobType:i,likeorUnlikeHandler:ne},t.id)),e.jsx(Me,{hasMore:((V=s==null?void 0:s.data)==null?void 0:V.totalUsers)>(r==null?void 0:r.length),click:se})]}):e.jsxs("div",{className:"text-center  flex-col gap-4 text-gray-400 col-span-4 h-full flex justify-center items-center",children:[e.jsxs("svg",{width:"152px",height:"152px",viewBox:"0 0 24.00 24.00",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),e.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",e.jsx("path",{opacity:"0.4",d:"M17.9981 7.16C17.9381 7.15 17.8681 7.15 17.8081 7.16C16.4281 7.11 15.3281 5.98 15.3281 4.58C15.3281 3.15 16.4781 2 17.9081 2C19.3381 2 20.4881 3.16 20.4881 4.58C20.4781 5.98 19.3781 7.11 17.9981 7.16Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{opacity:"0.4",d:"M16.9675 14.4402C18.3375 14.6702 19.8475 14.4302 20.9075 13.7202C22.3175 12.7802 22.3175 11.2402 20.9075 10.3002C19.8375 9.59016 18.3075 9.35016 16.9375 9.59016",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{opacity:"0.4",d:"M5.96656 7.16C6.02656 7.15 6.09656 7.15 6.15656 7.16C7.53656 7.11 8.63656 5.98 8.63656 4.58C8.63656 3.15 7.48656 2 6.05656 2C4.62656 2 3.47656 3.16 3.47656 4.58C3.48656 5.98 4.58656 7.11 5.96656 7.16Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{opacity:"0.4",d:"M6.9975 14.4402C5.6275 14.6702 4.1175 14.4302 3.0575 13.7202C1.6475 12.7802 1.6475 11.2402 3.0575 10.3002C4.1275 9.59016 5.6575 9.35016 7.0275 9.59016",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{d:"M12.0001 14.6302C11.9401 14.6202 11.8701 14.6202 11.8101 14.6302C10.4301 14.5802 9.33008 13.4502 9.33008 12.0502C9.33008 10.6202 10.4801 9.47021 11.9101 9.47021C13.3401 9.47021 14.4901 10.6302 14.4901 12.0502C14.4801 13.4502 13.3801 14.5902 12.0001 14.6302Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("path",{d:"M9.0907 17.7804C7.6807 18.7204 7.6807 20.2603 9.0907 21.2003C10.6907 22.2703 13.3107 22.2703 14.9107 21.2003C16.3207 20.2603 16.3207 18.7204 14.9107 17.7804C13.3207 16.7204 10.6907 16.7204 9.0907 17.7804Z",stroke:"#292D32",strokeWidth:"0.672",strokeLinecap:"round",strokeLinejoin:"round"})," "]})]}),e.jsx("p",{className:"text-gray-500 text-lg",children:n.noMatchesYet})]})}),(j||B)&&e.jsx(C.div,{className:"absolute top-0 left-0 w-full h-full bg-gray-100 z-50",variants:$e,initial:"initial",animate:"animate",exit:"exit",children:e.jsxs("span",{className:"w-full h-full relative",children:[B?e.jsx(be,{}):e.jsx(Ne,{applicantDetail:N==null?void 0:N.data,className:"h-full w-full overflow-y-auto"}),e.jsx("button",{onClick:te,className:"absolute top-3 left-3  bg-white w-10 h-10 rounded-full flex justify-center items-center text-secondaryColor",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})})})]})},"matchDetail")]})]})]})},Ue={initial:{opacity:0},animate:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}},$e={initial:{opacity:0,x:100},animate:{opacity:1,x:0,transition:{duration:.2}},exit:{opacity:0,x:100,transition:{duration:.2}}};export{qe as default};
