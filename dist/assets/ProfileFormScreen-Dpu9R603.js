import{H as ee,I as ae,J as re,r as i,Y as le,$ as te,E as r,U as se,a2 as oe,O as t,a3 as o,a4 as v,a5 as ne,aU as ie,a0 as d,M as p,G as ue,aV as ce,a1 as me,W as de}from"./index-DgIL6vzg.js";import{d as pe,D as fe}from"./default-BPeBs0U2.js";import{a as ge}from"./index-CCVGW56o.js";const be=[{value:"100",label:"100"},{value:"200",label:"200"},{value:"300",label:"300"},{value:"400",label:"400"}],_e=()=>{const x=ee(),b=ae(),{token:u,verified:_}=re(a=>a.auth),[j,N]=i.useState(pe),[w,f]=i.useState(!1),[E,y]=i.useState(!1),[m,k]=i.useState(null),[S,C]=i.useState([]),[ye,D]=i.useState([]),[P,g]=i.useState(!1),[l,s]=i.useState({name:"",industry_type_id:{label:"",value:""},budget:"",starting:"",staff:{label:"",value:""},area:"",prefecture:"",photo:"",company_des:"",manager:"",company_address:"",secondary_email:"",phone_number:"",ceo:"",yt_url:"",ig_url:"",web_url:"",fb_url:""}),{ProfileFormHandleError:q,companyNameError:I,industryTypeError:$,budgetStringError:A,startingError:T,staffError:F,prefectureError:O,companyDesError:L,photoError:R,companyAddressError:U,undertakeError:Y,chairmanError:M,phoneNumberError:B,areaError:G,facebookError:H,youtubeError:J,instagramError:V,websiteError:z,emailError:W,resetProfileFormError:K}=le();i.useEffect(()=>{(async()=>{try{const e=await d({endpoint:p.JOB_TYPES,method:"GET",token:u});C(e.data.map(c=>({value:c.id.toString(),label:c.job_type_jp})));const n=await d({endpoint:p.CITY,method:"GET",token:u});D(n.data.map(c=>({label:c.area,value:c.id.toString()})))}catch(e){console.error("Error fetching data:",e)}})()},[u]);const{mutate:Q}=te({mutationFn:a=>{g(!0);const e=new FormData;return e.append("file",a),d({endpoint:p.UPLOAD_IMAGE,method:"POST",body:{file:e.get("file")},file:!0,token:u})},onSuccess:a=>{N("https://api.japanjob.exbrainedu.com/v1/file/photo/"+a.data.filename),s(e=>({...e,photo:a.data.filename}))},onError:a=>{console.error("Error uploading image:",a),g(!1)},onSettled:()=>{y(!1)}}),X=a=>{var n;const e=(n=a.target.files)==null?void 0:n[0];e&&(y(!0),Q(e))},h=a=>{const e=a.replace(/\D/g,"");return e.length<=3?e:e.length<=7?`${e.slice(0,3)} ${e.slice(3)}`:e.length<=11?`${e.slice(0,3)} ${e.slice(3,7)} ${e.slice(7,11)}`:`${e.slice(0,3)} ${e.slice(3,7)} ${e.slice(7,11)} ${e.slice(11,15)}`},Z=async a=>{a.preventDefault(),K();try{const e={name:l.name||void 0,industry_type_id:Number(l.industry_type_id.value)||void 0,budget:Number(l.budget)||void 0,starting:l.starting?ue(l.starting).format("YYYY-MM-DD"):void 0,staff:Number(l.staff.value)||void 0,prefecture:l.prefecture||void 0,company_des:l.company_des||void 0,address:l.company_address||void 0,manager:l.manager||void 0,phone_number:l.phone_number||void 0,yt_url:l.yt_url||void 0,fb_url:l.fb_url||void 0,web_url:l.web_url||void 0,ig_url:l.ig_url||void 0,ceo:l.ceo||void 0,secondary_email:l.secondary_email||void 0,area:l.area||void 0};f(!0);const n=await d({endpoint:p.PROFILE,method:"PUT",body:e,token:u});n.success?(_==!1&&b(ce(!0)),localStorage.setItem("isCompletedProfile","true"),f(!1),b(me(n.data.name)),x(de.DASHBOARD)):console.error("Failed to update profile:",n.message)}catch(e){k(e),f(!1),console.error("Error updating profile:",e)}};return i.useEffect(()=>{m&&q(m==null?void 0:m.message)}),r.jsx("div",{className:"bg-gray-200 min-h-screen flex items-center justify-center",children:r.jsxs(se.div,{className:"w-full max-w-4xl bg-white rounded-xl p-8 shadow-lg",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5},children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"w-12",children:r.jsx("img",{src:oe,className:"w-full",alt:"Japan job logo"})}),r.jsx("h1",{className:"font-medium text-2xl",children:t.completeProfile})]}),r.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between w-full mb-6",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("h2",{className:"sub-title text-black",children:t.profilePhoto}),r.jsx("p",{children:t.profilePhotoDescription})]}),r.jsx("label",{htmlFor:"avatar-upload",className:"cursor-pointer",children:r.jsx("div",{className:`w-[70px] h-[70px] rounded-full overflow-hidden ${R?"border border-red-500 p-1":""}`,children:r.jsxs("div",{className:"w-full h-full object-cover ",children:[P&&r.jsx("div",{className:"w-full h-full flex items-center justify-center",children:r.jsx(ge,{circle:!0,height:80,width:80})}),r.jsx("img",{className:"w-full h-full object-cover rounded-full",src:j,crossOrigin:"anonymous",alt:"Profile avatar",onLoad:()=>g(!1)})]})})}),r.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:X,disabled:E})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[r.jsx(o,{name:"name",type:"text",placeholder:t.companyName,label:t.companyName,className:"mt-1 block w-full bg-gray-100",value:l.name,onChange:a=>s(e=>({...e,name:a.target.value})),error:I||"",required:!1}),r.jsx(v,{name:"industry_type_id",label:t.jobArea,id:t.jobArea,options:S,className:"",defaultOption:t.chooseIndustry,value:l.industry_type_id,onChange:a=>{s(e=>{var n;return{...e,industry_type_id:{label:(n=a.target)==null?void 0:n.labels,value:a.target.value}}})},error:$||""}),r.jsx(o,{name:"secondary_email",type:"email",placeholder:"",label:t.email,className:"mt-1 block w-full bg-gray-100",value:l.secondary_email,onChange:a=>s(e=>({...e,secondary_email:a.target.value})),error:W||"",required:!1}),r.jsx(o,{name:"phone_number",type:"text",placeholder:"08x xxxx xxxx",label:t.phoneNumber,className:"mt-1 block w-full bg-gray-100",value:h(l.phone_number),onChange:a=>{s(e=>({...e,phone_number:h(a.target.value)}))},error:B||"",required:!1}),r.jsx(o,{name:"budget",type:"number",label:t.investmentAmount,className:"mt-1 block w-full bg-gray-100",placeholder:"100000 $",value:l.budget,onChange:a=>s(e=>({...e,budget:a.target.value})),error:A||"",required:!1}),r.jsx(o,{name:"company_address",type:"text",label:t.companyAddress,className:"mt-1 block w-full bg-gray-100",value:l.company_address=="null"?"":l.company_address,onChange:a=>s(e=>({...e,company_address:a.target.value})),error:U||"",required:!1}),r.jsx(o,{name:"ceo",type:"text",label:t.chairman,className:"mt-1 block w-full bg-gray-100",value:l.ceo=="null"?"":l.ceo,onChange:a=>s(e=>({...e,ceo:a.target.value})),error:M||"",required:!1}),r.jsx(o,{name:"manager",type:"text",label:t.undertake,className:"mt-1 block w-full bg-gray-100",value:l.manager,onChange:a=>s(e=>({...e,manager:a.target.value})),error:Y||"",required:!1}),r.jsx(v,{name:"staff",label:t.employeeNumber,id:t.employeeNumber,options:be,className:"",defaultOption:t.chooseEmployee,value:l.staff,onChange:a=>s(e=>({...e,staff:{label:a.target.labels,value:a.target.value}})),error:F||""}),r.jsx(o,{name:"area",type:"text",label:t.area,className:"mt-1 block w-full bg-gray-100",value:l.area,onChange:a=>s(e=>({...e,area:a.target.value})),error:G||"",required:!1}),r.jsx(fe,{name:"starting",type:"date",label:t.establishment,className:"mt-1 block w-full",value:l.starting,onChange:a=>s(e=>({...e,starting:a.target.value})),error:T||""}),r.jsx(o,{name:"prefecture",type:"text",label:t.city,className:"mt-1 block w-full bg-gray-100",value:l.prefecture,onChange:a=>s(e=>({...e,prefecture:a.target.value})),error:O||"",required:!1}),r.jsx(o,{name:"fb_url",type:"url",label:t.facebook,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.fb_url,onChange:a=>s(e=>({...e,fb_url:a.target.value})),error:H||"",required:!1}),r.jsx(o,{name:"yt_url",type:"url",label:t.youtube,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.yt_url,onChange:a=>s(e=>({...e,yt_url:a.target.value})),error:J||"",required:!1}),r.jsx(o,{name:"web_url",type:"url",label:t.website,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.web_url,onChange:a=>s(e=>({...e,web_url:a.target.value})),error:z||"",required:!1}),r.jsx(o,{name:"ig_url",type:"url",label:t.instagram,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.ig_url,onChange:a=>s(e=>({...e,ig_url:a.target.value})),error:V||"",required:!1}),r.jsx("span",{className:"col-span-2",children:r.jsx(o,{name:"company_des",type:"text",label:t.companyDescription,className:"mt-1 block w-full bg-gray-100",placeholder:"Company description",value:l.company_des,onChange:a=>s(e=>({...e,company_des:a.target.value})),error:L||"",required:!1})})]}),r.jsx(ne,{type:"submit",className:"w-full",children:w?r.jsx(ie,{color:"#fff",size:5}):t.finish})]})]})})};export{_e as default};
