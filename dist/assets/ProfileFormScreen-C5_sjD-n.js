import{H as se,I as te,J as oe,r as n,Y as ne,$ as ie,E as r,U as ue,a2 as ce,O as s,a3 as o,a4 as _,a5 as de,aV as me,a7 as pe,a0 as m,M as p,G as fe,aW as ge,a1 as be,W as he}from"./index-D1IItCOn.js";import{d as ye,D as ve}from"./default-D10DGQbS.js";import{a as xe}from"./index-Cwi9KaUg.js";const _e=[{value:"100",label:"100"},{value:"200",label:"200"},{value:"300",label:"300"},{value:"400",label:"400"}],Se=()=>{const j=se(),h=te(),{token:u,verified:N}=oe(a=>a.auth),[w,E]=n.useState(ye),[S,f]=n.useState(!1),[k,y]=n.useState(!1),[d,C]=n.useState(null),[D,P]=n.useState([]),[je,q]=n.useState([]),[I,g]=n.useState(!1),[A,v]=n.useState(""),[$,b]=n.useState(!1),[l,t]=n.useState({name:"",industry_type_id:{label:"",value:""},budget:"",starting:"",staff:{label:"",value:""},area:"",prefecture:"",photo:"",company_des:"",manager:"",company_address:"",secondary_email:"",phone_number:"",ceo:"",yt_url:"",ig_url:"",web_url:"",fb_url:""}),{ProfileFormHandleError:F,companyNameError:O,industryTypeError:T,budgetStringError:M,startingError:L,staffError:R,prefectureError:Y,companyDesError:U,photoError:B,companyAddressError:G,undertakeError:H,chairmanError:J,phoneNumberError:V,areaError:W,facebookError:z,youtubeError:K,instagramError:Q,websiteError:X,emailError:Z,resetProfileFormError:ee}=ne();n.useEffect(()=>{(async()=>{try{const e=await m({endpoint:p.JOB_TYPES,method:"GET",token:u});P(e.data.map(c=>({value:c.id.toString(),label:c.job_type_jp})));const i=await m({endpoint:p.CITY,method:"GET",token:u});q(i.data.map(c=>({label:c.area,value:c.id.toString()})))}catch(e){console.error("Error fetching data:",e)}})()},[u]);const{mutate:ae}=ie({mutationFn:a=>{b(!0);const e=new FormData;return e.append("file",a),m({endpoint:p.UPLOAD_IMAGE,method:"POST",body:{file:e.get("file")},file:!0,token:u})},onSuccess:a=>{E("https://api.japanjob.exbrainedu.com/v1/file/photo/"+a.data.filename),t(e=>({...e,photo:a.data.filename}))},onError:a=>{v(a.message),g(!0),console.error("Error uploading image:",a),b(!1)},onSettled:()=>{y(!1)}}),re=a=>{var i;const e=(i=a.target.files)==null?void 0:i[0];e&&(y(!0),ae(e))},x=a=>{const e=a.replace(/\D/g,"");return e.length<=3?e:e.length<=7?`${e.slice(0,3)} ${e.slice(3)}`:e.length<=11?`${e.slice(0,3)} ${e.slice(3,7)} ${e.slice(7,11)}`:`${e.slice(0,3)} ${e.slice(3,7)} ${e.slice(7,11)} ${e.slice(11,15)}`},le=async a=>{a.preventDefault(),ee();try{const e={name:l.name||void 0,industry_type_id:Number(l.industry_type_id.value)||void 0,budget:Number(l.budget)||void 0,starting:l.starting?fe(l.starting).format("YYYY-MM-DD"):void 0,staff:Number(l.staff.value)||void 0,prefecture:l.prefecture||void 0,company_des:l.company_des||void 0,address:l.company_address||void 0,manager:l.manager||void 0,phone_number:l.phone_number||void 0,yt_url:l.yt_url||void 0,fb_url:l.fb_url||void 0,web_url:l.web_url||void 0,ig_url:l.ig_url||void 0,ceo:l.ceo||void 0,secondary_email:l.secondary_email||void 0,area:l.area||void 0};f(!0);const i=await m({endpoint:p.PROFILE,method:"PUT",body:e,token:u});i.success?(N==!1&&h(ge(!0)),localStorage.setItem("isCompletedProfile","true"),f(!1),h(be(i.data.name)),j(he.DASHBOARD)):console.error("Failed to update profile:",i.message)}catch(e){C(e),f(!1),console.error("Error updating profile:",e)}};return n.useEffect(()=>{d&&F(d==null?void 0:d.message)}),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-gray-200 min-h-screen flex items-center justify-center py-5",children:r.jsxs(ue.div,{className:"w-full max-w-4xl bg-white rounded-xl p-8 shadow-lg",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5},children:[r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"w-12",children:r.jsx("img",{src:ce,className:"w-full",alt:"Japan job logo"})}),r.jsx("h1",{className:"font-medium text-2xl",children:s.completeProfile})]}),r.jsxs("form",{onSubmit:le,className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between w-full mb-6",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("h2",{className:"sub-title text-black",children:s.profilePhoto}),r.jsx("p",{children:s.profilePhotoDescription})]}),r.jsx("label",{htmlFor:"avatar-upload",className:"cursor-pointer",children:r.jsx("div",{className:`w-[70px] h-[70px] rounded-full overflow-hidden ${B?"border border-red-500 p-1":""}`,children:r.jsxs("div",{className:"w-full h-full object-cover ",children:[$&&r.jsx("div",{className:"w-full h-full flex items-center justify-center",children:r.jsx(xe,{circle:!0,height:80,width:80})}),r.jsx("img",{className:"w-full h-full object-cover rounded-full",src:w,crossOrigin:"anonymous",alt:"Profile avatar",onLoad:()=>b(!1)})]})})}),r.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:re,disabled:k})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[r.jsx(o,{name:"name",type:"text",placeholder:s.companyName,label:s.companyName,className:"mt-1 block w-full bg-gray-100",value:l.name,onChange:a=>t(e=>({...e,name:a.target.value})),error:O||"",required:!1}),r.jsx(_,{name:"industry_type_id",label:s.jobArea,id:s.jobArea,options:D,className:"",defaultOption:s.chooseIndustry,value:l.industry_type_id,onChange:a=>{t(e=>{var i;return{...e,industry_type_id:{label:(i=a.target)==null?void 0:i.labels,value:a.target.value}}})},error:T||""}),r.jsx(o,{name:"secondary_email",type:"email",placeholder:"",label:s.email,className:"mt-1 block w-full bg-gray-100",value:l.secondary_email,onChange:a=>t(e=>({...e,secondary_email:a.target.value})),error:Z||"",required:!1}),r.jsx(o,{name:"phone_number",type:"text",placeholder:"08x xxxx xxxx",label:s.phoneNumber,className:"mt-1 block w-full bg-gray-100",value:x(l.phone_number),onChange:a=>{t(e=>({...e,phone_number:x(a.target.value)}))},error:V||"",required:!1}),r.jsx(o,{name:"budget",type:"number",label:s.investmentAmount,className:"mt-1 block w-full bg-gray-100",placeholder:"100000 $",value:l.budget,onChange:a=>t(e=>({...e,budget:a.target.value})),error:M||"",required:!1}),r.jsx(o,{name:"company_address",type:"text",label:s.companyAddress,className:"mt-1 block w-full bg-gray-100",value:l.company_address=="null"?"":l.company_address,onChange:a=>t(e=>({...e,company_address:a.target.value})),error:G||"",required:!1}),r.jsx(o,{name:"ceo",type:"text",label:s.chairman,className:"mt-1 block w-full bg-gray-100",value:l.ceo=="null"?"":l.ceo,onChange:a=>t(e=>({...e,ceo:a.target.value})),error:J||"",required:!1}),r.jsx(o,{name:"manager",type:"text",label:s.undertake,className:"mt-1 block w-full bg-gray-100",value:l.manager,onChange:a=>t(e=>({...e,manager:a.target.value})),error:H||"",required:!1}),r.jsx(_,{name:"staff",label:s.employeeNumber,id:s.employeeNumber,options:_e,className:"",defaultOption:s.chooseEmployee,value:l.staff,onChange:a=>t(e=>({...e,staff:{label:a.target.labels,value:a.target.value}})),error:R||""}),r.jsx(o,{name:"area",type:"text",label:s.area,className:"mt-1 block w-full bg-gray-100",value:l.area,onChange:a=>t(e=>({...e,area:a.target.value})),error:W||"",required:!1}),r.jsx(ve,{name:"starting",type:"date",label:s.establishment,className:"mt-1 block w-full",value:l.starting,onChange:a=>t(e=>({...e,starting:a.target.value})),error:L||""}),r.jsx(o,{name:"prefecture",type:"text",label:s.city,className:"mt-1 block w-full bg-gray-100",value:l.prefecture,onChange:a=>t(e=>({...e,prefecture:a.target.value})),error:Y||"",required:!1}),r.jsx(o,{name:"fb_url",type:"url",label:s.facebook,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.fb_url,onChange:a=>t(e=>({...e,fb_url:a.target.value})),error:z||"",required:!1}),r.jsx(o,{name:"yt_url",type:"url",label:s.youtube,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.yt_url,onChange:a=>t(e=>({...e,yt_url:a.target.value})),error:K||"",required:!1}),r.jsx(o,{name:"web_url",type:"url",label:s.website,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.web_url,onChange:a=>t(e=>({...e,web_url:a.target.value})),error:X||"",required:!1}),r.jsx(o,{name:"ig_url",type:"url",label:s.instagram,className:"mt-1 block w-full bg-gray-100",placeholder:"",value:l.ig_url,onChange:a=>t(e=>({...e,ig_url:a.target.value})),error:Q||"",required:!1}),r.jsx("span",{className:"col-span-2",children:r.jsx(o,{name:"company_des",type:"text",label:s.companyDescription,className:"mt-1 block w-full bg-gray-100",placeholder:"Company description",value:l.company_des,onChange:a=>t(e=>({...e,company_des:a.target.value})),error:U||"",required:!1})})]}),r.jsx(de,{type:"submit",className:"w-full",children:S?r.jsx(me,{color:"#fff",size:5}):s.finish})]})]})}),r.jsx(pe,{isOpen:I,onClose:()=>g(!1),children:r.jsxs("div",{className:"p-6",children:[r.jsx("p",{className:"mb-4",children:A}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded",onClick:()=>{g(!1),v("")},children:s.confirm})})]})})]})};export{Se as default};
